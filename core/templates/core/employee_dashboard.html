{% extends "core/employee_base.html" %}

{% block title %}Employee Dashboard | 15-Five{% endblock %}

{% block content %}

<h1 class="page-title">Employee Dashboard</h1>

<!-- KPI CARD -->
<div class="kpi-card">
    <div class="kpi-icon success-icon">
        <i class="bi bi-check-circle"></i>
    </div>
    <div>
        <div class="kpi-label">Total Check-Ins Submitted</div>
        <div class="kpi-value">{{ submitted_count }}</div>
    </div>
</div>

<h2 class="section-title">Pending Check-Ins</h2>

{% if pending_checkins %}
    {% for assignment in pending_checkins %}
        <div class="checkin-card">
            <div class="checkin-left">
                <div class="checkin-icon pending-icon">
                    <i class="bi bi-clock"></i>
                </div>
                <div>
                    <div class="checkin-title">
                        {{ assignment.checkin_form.start_date|date:"d M Y" }}
                        →
                        {{ assignment.checkin_form.end_date|date:"d M Y" }}
                    </div>
                    <div class="checkin-date">
                        {{ assignment.checkin_form.title }}
                    </div>
                </div>
            </div>

            <div class="checkin-right">
                {% if assignment.status == "PARTIAL" %}
                    <span class="badge rounded-pill bg-warning-subtle text-warning">
                        Partially Filled
                    </span>
                {% else %}
                    <span class="badge rounded-pill bg-warning-subtle text-warning">
                        Pending
                    </span>
                {% endif %}

                <a href="{% url 'employee_checkin_form' assignment.id %}"
                   class="primary-btn">
                    {% if assignment.status == "PARTIAL" %}
                        Continue
                    {% else %}
                        Submit
                    {% endif %}
                </a>
            </div>
        </div>
    {% endfor %}
{% else %}
    <p style="color:#64748b;">No pending check-ins</p>
{% endif %}

{% if submitted_checkins %}
    <h2 class="section-title">Recently Submitted</h2>

    {% for assignment in submitted_checkins %}
        <div class="checkin-card">
            <div class="checkin-left">
                <div class="checkin-icon success-icon">
                    <i class="bi bi-check-circle"></i>
                </div>
                <div>
                    <div class="checkin-title">
                        {{ assignment.checkin_form.start_date|date:"d M Y" }}
                        →
                        {{ assignment.checkin_form.end_date|date:"d M Y" }}
                    </div>
                    <div class="checkin-date">
                        {{ assignment.checkin_form.title }}
                    </div>
                </div>
            </div>

            <div class="checkin-right">
                <span class="badge rounded-pill bg-success-subtle text-success">
                    Submitted
                </span>

                <a href="{% url 'employee_checkin_form' assignment.id %}"
                   class="primary-btn outline">
                    View
                </a>
            </div>
        </div>
    {% endfor %}
{% endif %}

{% endblock %}
