{% extends "core/admin_base.html" %}

{% block title %}Employee Check-Ins{% endblock %}

{% block content %}
<div class="container-fluid px-4 py-4">

  <!-- HEADER -->
  <div class="mb-4">
    <h1 class="fw-bold mb-1">Check-Ins</h1>
    <p class="text-muted mb-0">
      Employee submissions for <strong>{{ employee.email }}</strong>
    </p>
  </div>

  <!-- SUMMARY -->
  <div class="card border-0 shadow-sm mb-4">
    <div class="card-body">
      <div class="row text-center">
        <div class="col-md-4">
          <h4 class="fw-bold">{{ assignments|length }}</h4>
          <p class="text-muted mb-0">Assigned Check-Ins</p>
        </div>

        <div class="col-md-4">
          <h4 class="fw-bold text-success">
            {{ assignments|length }}
          </h4>
          <p class="text-muted mb-0">Total Entries</p>
        </div>

        <div class="col-md-4">
          <h4 class="fw-bold text-muted">—</h4>
          <p class="text-muted mb-0">Period</p>
        </div>
      </div>
    </div>
  </div>

  <!-- TABLE -->
  <div class="card border-0 shadow-sm">
    <div class="table-responsive">
      <table class="table align-middle mb-0">

        <thead class="table-light">
          <tr>
            <th>Check-In</th>
            <th>Period</th>
            <th>Status</th>
            <th>Review Status</th>
            <th class="text-end">Action</th>
          </tr>
        </thead>

        <tbody>
          {% for assignment in assignments %}
          <tr class="border-top">

            <!-- CHECK-IN TITLE -->
            <td class="fw-semibold">
              {{ assignment.checkin_form.title }}
            </td>

            <!-- PERIOD -->
            <td>
              {{ assignment.checkin_form.start_date|date:"d M Y" }}
              →
              {{ assignment.checkin_form.end_date|date:"d M Y" }}
            </td>

            <!-- SUBMISSION STATUS -->
            <td>
              {% if assignment.status == "SUBMITTED" %}
                <span class="badge bg-success">Submitted</span>
              {% else %}
                <span class="badge bg-warning text-dark">Pending</span>
              {% endif %}
            </td>

            <!-- REVIEW STATUS -->
            <td>
              {% if assignment.review_status == "REVIEWED" %}
                <span class="badge bg-primary">Reviewed</span>
              {% else %}
                <span class="badge bg-secondary">Pending</span>
              {% endif %}
            </td>

            <!-- ACTION -->
            <td class="text-end">
              {% if assignment.status == "SUBMITTED" %}
                <a
                  href="{% url 'admin_checkin_detail' assignment.id %}"
                  class="btn btn-sm btn-outline-primary"
                >
                  Review
                </a>
              {% else %}
                <span class="text-muted">Awaiting submission</span>
              {% endif %}
            </td>

          </tr>
          {% empty %}
          <tr>
            <td colspan="5" class="text-center py-5 text-muted">
              No check-ins assigned to this employee yet.
            </td>
          </tr>
          {% endfor %}
        </tbody>

      </table>
    </div>
  </div>

</div>
{% endblock %}
