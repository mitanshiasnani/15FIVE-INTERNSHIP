{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin Panel | 15-Five</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/admin.css' %}">

    <style>
        body {
            margin: 0;
            background-color: #f5f7fb;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        }

        .layout { display: flex; min-height: 100vh; }

        .sidebar {
            width: 260px;
            background-color: #1e3a5f;
            color: #ffffff;
            padding: 20px;
            display: flex;
            flex-direction: column;
            height: 100vh;
            position: fixed;
            left: 0;
            top: 0;
            z-index: 1100;
        }

        .logo {
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 50px;
            margin-left: 47px;
        }

        .nav-link {
            color: #cbd5e1;
            padding: 12px 16px;
            border-radius: 10px;
            margin-bottom: 6px;
            text-decoration: none;
            display: block;
        }

        .nav-link.active,
        .nav-link:hover {
            background-color: #3b82f6;
            color: #ffffff;
        }

        .main {
            flex: 1;
            padding: 40px;
            margin-left: 260px;
        }

        .admin-menu-btn {
            display: none;
            position: fixed;
            top: 16px;
            left: 16px;
            z-index: 1300;
            width: 44px;
            height: 44px;
            border-radius: 10px;
            border: none;
            background: #3b82f6;
            color: white;
            font-size: 22px;
        }

        .admin-overlay { display: none; }

        @media (max-width: 1024px) {
            .sidebar { transform: translateX(-100%); transition: transform 0.3s ease; }
            .sidebar.open { transform: translateX(0); }
            .admin-menu-btn { display: block; }
            .main { margin-left: 0; padding: 80px 20px; }

            .admin-overlay {
                display: block;
                position: fixed;
                inset: 0;
                background: rgba(15, 23, 42, 0.55);
                z-index: 1000;
                opacity: 0;
                pointer-events: none;
                transition: opacity 0.3s ease;
            }

            .admin-overlay.active {
                opacity: 1;
                pointer-events: auto;
            }
        }

        .loader-backdrop {
            position: fixed;
            inset: 0;
            background: rgba(15, 23, 42, 0.55);
            z-index: 2000;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        .spinner {
            width: 48px;
            height: 48px;
            border: 4px solid #e5e7eb;
            border-top: 4px solid #3b82f6;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        .loader-text { margin-top: 12px; color: #fff; font-weight: 600; }

        @keyframes spin { to { transform: rotate(360deg); } }
    </style>

    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <!-- GLOBAL DELETE CONFIRM (UNCHANGED) -->
    <script>
    document.addEventListener("submit", function (e) {
        const form = e.target;
        if (!form.classList.contains("delete-form")) return;

        e.preventDefault();

        Swal.fire({
            title: "Are you sure?",
            text: form.dataset.message || "This action cannot be undone.",
            icon: "warning",
            showCancelButton: true,
            confirmButtonColor: "#2563eb",
            cancelButtonColor: "#6b7280",
            confirmButtonText: "Yes, delete",
            cancelButtonText: "Cancel",
            reverseButtons: true
        }).then((result) => {
            if (result.isConfirmed) {
                document.getElementById("page-loader").style.display = "block";
                form.submit();
            }
        });
    });
    </script>
    <script>
        document.addEventListener("submit", function (e) {
            const form = e.target;
        
            if (!form.classList.contains("logout-form")) return;
        
            e.preventDefault();
        
            Swal.fire({
                title: "Confirm Logout",
                text: "Are you sure you want to log out?",
                icon: "warning",
                showCancelButton: true,
                confirmButtonColor: "#dc2626",
                cancelButtonColor: "#6b7280",
                confirmButtonText: "Yes, logout",
                cancelButtonText: "Cancel",
                reverseButtons: true
            }).then((result) => {
                if (result.isConfirmed) {
                    document.getElementById("page-loader").style.display = "block";
                    form.submit();
                }
            });
        });
        </script>
        
</head>

<body>

<div id="page-loader" style="display:none;">
    <div class="loader-backdrop">
        <div class="spinner"></div>
        <p class="loader-text">Please wait…</p>
    </div>
</div>

<button class="admin-menu-btn" onclick="toggleAdminSidebar()">☰</button>
<div class="admin-overlay" onclick="toggleAdminSidebar()"></div>

<div class="layout">
    <aside class="sidebar">
        <div class="logo">15-Five<div style="font-size:12px;color:#93c5fd;">Admin Panel</div></div>
        <a href="{% url 'admin_dashboard' %}" class="nav-link">Dashboard</a>
        <a href="{% url 'employee_list' %}" class="nav-link">Employees</a>
        <a href="{% url 'add_employee' %}" class="nav-link">Add Employee</a>
        <a href="{% url 'create_checkin' %}" class="nav-link">Create Check-In</a>
        <a href="{% url 'admin_checkins_list' %}" class="nav-link">Check-In History</a>
        <a href="{% url 'manage_default_questions' %}" class="nav-link">Default Questions</a>
        <a href="{% url 'admin_seetings' %}" class="nav-link">Settings</a>
    </aside>

    <main class="main">
        {% if messages %}
            {% for message in messages %}
                <div class="alert alert-{{ message.tags }}">{{ message }}</div>
            {% endfor %}
        {% endif %}
        {% block content %}{% endblock %}
    </main>
</div>

<script>
function toggleAdminSidebar() {
    document.querySelector('.sidebar').classList.toggle('open');
    document.querySelector('.admin-overlay').classList.toggle('active');
}
</script>

{% block scripts %}{% endblock %}
</body>
</html>
